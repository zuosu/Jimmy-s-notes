# 周报（时间：220826）
本周主要完成的工作有：  
1. 学习了python的扩展程序库numpy。
2. 整理了《最优化理论与算法》第十三章 惩罚函数法，如下。
3. 和队友一起完成数学建模——基于测井曲线的储层油气性识别与物性预测研究的训练题，解决该问题的基本思想是使用支持向量机来完成多分类和预测。
# 第十三章 惩罚函数法
本章介绍另一类约束最优化方法——惩罚函数法，这类方法的基本思想是，借助罚函数将约束问题转化为无约束问题，进而用无约束最优化方法来求解。
## 13.1 外点罚函数法
考虑约束问题
$$
\begin{aligned}
min &\quad f(x)\\
s.t. &\quad g_i(x)\ge0,\quad i=1,\cdots,m\\
&\quad h_j(x)=0,j=1,\cdots,l
\end{aligned}\tag{13.1.1}
$$

其中$f(x)，g_i(x)(i=1,\cdots,m)$和$h_i(x)(j=1,\cdots,l)$是$R^n$上的连续函数。

### 13.1.1 基本思想
将约束优化问题化成无约束优化问题。由目标函数和约束函数组成辅助函数，使其既能满足约束又能使目标函数值下降。罚函数的基本任务是对满足约束的点不做惩罚，对不满足约束的迭代点进行惩罚，外点罚函数可以从不满足约束的初始点出发，迭代点对约束的违背程度越大，罚函数的惩罚就越大。

1. 对于等式约束问题

$$
\begin{aligned}
min &\quad f(x)\\
s.t. &\quad h_j(x)=0,\quad j=1,\cdots,l
\end{aligned}\tag{13.1.2}
$$

可定义辅助函数
$$
F_1(x,\sigma)=f(x)+\sigma \sum_{j=1}^lh_j^2(x)\tag{13.1.3}
$$

参数$\sigma$是很大的正数，这样就把（13.1.2）式转化为无约束问题
$$
min \quad F_1(x,\sigma)\tag{13.1.4}
$$
显然（13.1.4）式的最优解必使得$h_j(x)$接近零，因为如若不然，（13.1.3）式的第二项将是很大的正数，现行点必不是极小点，由此可见，求解问题（13.1.4）能够得到问题的近似解。

2. 对于不等式约束问题

$$
\begin{aligned}
min &\quad f(x)\\
s.t. &\quad g_i(x)\ge0,\quad j=1,\cdots,m
\end{aligned}\tag{13.1.5}
$$

辅助函数的形式与等式约束情形不同，但构造辅助函数的基本思想是一致的，这就是在可行点辅助函数值等于原来的目标函数值，在不可行点，辅助函数值等于原来的目标函数值加上一个很大的正数，根据这样的原则，对于不等式玉树问题（13.1.5），我们定义函数
$$
F_2(x,\sigma)=f(x)+\sigma \sum_{i=1}^m[max\{0,-g_i(x)\}]^2\tag{13.1.6}
$$
参数$\sigma$是很大的正数，这样就把（13.1.2）式转化为无约束问题

$$
min \quad F_2(x,\sigma)\tag{13.1.7}
$$
通过（13.1.7）式求得（13.1.5）式的近似解。

把上述思想加以推广，对于一般情形（13.1.1）式，可定义函数
$$
F(x,\sigma)=f(x)+\sigma P(x)\tag{13.1.8}
$$
其中$P(x)$具有下列形式，
$$
P(x)=\sum_{i=1}^m\phi(g_i(x))+\sum_{j=1}^l\psi(h_j(x))
$$
$\phi,\psi$是满足下列条件的连续函数，
$$
\begin{aligned}
\phi(y)=0,y\ge0;\\
\phi(y)>0,y<0;\\
\psi(y=0),y=0;\\
\psi(y>0),y\neq0;\\
\end{aligned}
$$
函数$\phi,\psi$的典型取法如
$$
\begin{aligned}
&\phi = [max\{0,-g_i(x)\}]^\alpha\\
&\psi = |h_j(x)|^{\beta}
\end{aligned}
$$
其中$\alpha\ge1,\beta\ge1$，均为给定常数，通常取做$\alpha=\beta=2$

这样把约束问题（13.1.1）转化为无约束问题
$$
min \quad F(x,\sigma)=^{def}= f(x)+\sigma P(x)\tag{13.1.10}
$$
其中$\sigma$是很大的正数，$P(x)$是连续函数。

通常将$\sigma P(x)$称为罚项，$\sigma$称为罚因子，$F(x,\sigma)$称为罚函数。

### 13.1.2 计算步骤

实际计算中，罚因子$\sigma$的选择十分重要，如果$\sigma$过大，则给罚函数的极小化增加计算上的困难；如果$\sigma$太小，则罚函数的极小点远离约束问题的最优解，计算效率差。因此，一般策略是取一个趋向于无穷大的严格递增正数列$\{ \sigma_k\}$，从某个$\sigma_1$开始，对每个k，求解
$$
min \quad f(x)+\sigma_kP(x)\tag{13.1.11}
$$
从而得到一个极小点的序列$\{\bar{x_{\sigma k}}\}$，在适当的条件下，这个序列将收敛于约束问题的最优解。如此通过求解一系列无约束问题来获得约束问题最优解的方法称为**序列无约束极小化方法**，简称SUMT方法。

外点罚函数的计算步骤如下：

![](https://files.mdnice.com/user/25190/71062226-b0a6-46ea-a563-6e5807bf2a14.png)

例题：
![](https://files.mdnice.com/user/25190/86da9be9-b33c-48eb-b313-9e79add654c5.png)

### 13.1.3 收敛性
定理：设问题（13.1.1）的可行域S非空，且存在一个$\epsilon>0$，使得集合
$$
S_{\epsilon}=\{x|g_i(x)\ge-\epsilon,i=1,\cdots,m,|h_j(x)\le \epsilon,j=1,\cdots,l|\}
$$
是紧的，又设$\{\sigma_k\}$是趋向无穷大的严格递增正数列，且对每个k，（13.1.11）式存在全局最优解$x_k$，则$\{x_k\}$存在一个收敛子序列$\{x_{kj}\}$，并且任何这样的收敛子序列的极限都是问题（13.1.1）的最优解。

## 13.2 内点罚函数
### 13.2.1 基本思想
从可行域的内部出发，使搜索始终保持在可行域内部，当搜索要达到边界时，对目标函数进行惩罚。因此，这种方法适用于下列只有不等式约束的问题：
$$
\begin{aligned}
min \quad f(x)\\
s.t. \quad g_i(x)\ge0
\end{aligned}\tag{13.2.1}
$$
其中$f(x),g_i(x),i=1,\cdots,m$是连续函数。将可行域记作
$$
S=\{x|g_i(x)\ge0,i=1,\cdots,m\}\tag{13.2.2}
$$
保持迭代点含于可行域内部的方法是定义**障碍函数**
$$
G(x,r)=f(x)+rB(x)\tag{12.2.3}
$$
其中$B(x)$是连续函数，当点$x$趋于可行域边界时，$B(x)\rightarrow +\infty$。$B(x)$的两种最重要的形式为
$$
B(x)=\sum_{i=1}^m\frac{1}{g_i(x)}\tag{13.2.4}
$$
及
$$
B(x)=-\sum_{i=1}^mlog \ g_i(x)\tag{13.2.5}
$$
式（13.2.5）仅适用于$g_i(x)<1$。$r$是很小的正数。这样，当$x$趋于边界时，函数$G(x,r)\rightarrow +\infty$；否则，由于r取值很小，则函数$G(x,r)$的取值近似$f(x)$。因此，可通过求解下列问题得到约束问题（13.2.1）的近似解：
$$
\begin{aligned}
min&\quad G(x,r)\\
s.t. &\quad x\in int \ S
\end{aligned}
$$
由于$B(x)$的存在，在可行域边界形成“围墙”，因此约束问题（13.2.6）的解$\bar{x_r}$必含于可行域的内部。

（13.2.6）仍是约束问题，看起来它的约束条件比原来的问题还要复杂，但是，由于函数$B(x)$的阻拦作用是自动实现的，因此从计算观点看，（13.2.6）式可当作无约束问题来处理。

### 13.2.2 计算步骤

根据障碍函数$G(x,r)$的定义，显然，r取值越小，约束问题（13.2.6）的最优解越接近约束问题（13.2.1）的最优解。但是，这里存在与外点法类似的问题，如果r太小，则给约束问题（13.2.6）的计算带来很大困难。因此，仍采用序列无约束极小化方法（SUMT），取一个严格单调减且趋于零的罚因子（障碍因子）数列$\{r_k\}$，对每一个k，从内部出发，求解问题
$$
\begin{aligned}
min\quad G(x,r_k)\\
s.t. \quad x\in in \ S
\end{aligned}
$$

内点罚函数计算步骤如下：

![](https://files.mdnice.com/user/25190/77e08fa9-b2de-4820-8172-073f37df257e.png)

例题：
![](https://files.mdnice.com/user/25190/e3553e79-5997-4cad-bfef-29658a55e586.png)

### 13.2.3 收敛性
定理： 设在问题（13.2.1）中，可行域内部$int S$非空，且存在最优解，又设对每一个$r_k$，障碍函数$G(x,r_k)$在$int S$内存在极小点，并且内点罚函数产生的全局极小点序列$\{x_k\}$存在子序列收敛道$\bar{x}$，则$\bar{x}$是问题（13.2.1）的全局最优解。

## 13.3 总结
外点法和内点法均采用序列无约束极小化技巧，方法简单，使用方便，并能用来求解导数不存在的问题，因此这种算法对实际工作者确有吸引力，而且已经得到比较广泛的应用。但是，上述罚函数存在固有的缺点，这就是随着罚因子趋向其极限，罚函数的Hesse矩阵的条件数无限增大，因而越来越变得病态。罚函数的这种形态给无约束极小化带来很大困难。